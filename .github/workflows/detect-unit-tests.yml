name: Detect Unit Test PR

on:
  pull_request:
    types: [opened, synchronize, reopened]

jobs:
  check-spec-files:
    runs-on: ubuntu-latest
    if: github.event.pull_request.draft == false
    steps:
      - name: Checkout PR code
        uses: actions/checkout@v3
        with:
          fetch-depth: 0  # Needed for git diff across branches

      - name: Detect .spec.js files using git diff
        run: |
          echo "üîç Checking for .spec.js files in this PR..."

          BASE_REF="${{ github.event.pull_request.base.ref }}"
          echo "üîÅ Fetching base branch: $BASE_REF"
          git fetch origin "$BASE_REF"

          CHANGED_FILES=$(git diff --name-only origin/"$BASE_REF"...HEAD)
          echo "$CHANGED_FILES"

          if echo "$CHANGED_FILES" | grep '\.spec\.js$'; then
            echo "‚úÖ Now Unit Tests detected"
          else
            echo "‚ÑπÔ∏è No .spec.js files found in this PR"
          fi
